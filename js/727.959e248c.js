"use strict";(self["webpackChunkdbd_management_system"]=self["webpackChunkdbd_management_system"]||[]).push([[727],{5727:function(e,a,l){l.r(a),l.d(a,{default:function(){return B}});var t=l(1326),u=(l(8380),l(7778),l(6675)),s=(l(3594),l(2575)),r=(l(3233),l(4079)),o=(l(9234),l(988)),n=(l(3843),l(4871)),i=(l(1500),l(4849),l(3429)),d=(l(1236),l(8700),l(5718)),p=(l(4541),l(8015)),c=(l(358),l(5026),l(4603)),m=l(7419),v=l(7235),g=(l(289),l(1194)),b=(l(8809),l(8358)),k=(l(1514),l(6527),l(9306),l(8589),l(2279)),f=l(5251);const _=e=>(console.log("页码信息："+e.page),console.log("每页展示："+e.pageSize),f.A.get("/map",{params:e})),y=e=>f.A.get(`/map/${e}`),F=()=>f.A.get("/map/all/series"),w=e=>f.A.post("/admin/map/add",e),h=e=>f.A.put("/admin/map/update",e),S=e=>f.A.delete(`/admin/map/delete/${e}`);var R=l(2796);l(5397);const V=["src"],z={class:"editor"};var C={__name:"MapEdit",emits:["success"],setup(e,{expose:a,emit:l}){const t=(0,m.KR)(!1),u=(0,m.KR)(),s={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"用户名必须是2-10位的字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^\S{6,12}$/,message:"密码必须是6-12位的非空字符",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{validator:(e,a,l)=>{a<0||a>200?l(new Error("请确保输入的年龄在0-200之间")):l()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"邮箱格式不正确，请检查输入内容",trigger:"blur"}]},r=(0,m.KR)({modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{color:[]},{background:[]}]]}}),o={name:"",password:"",description:"",series:"",image:""},n=(0,m.KR)(""),f=(0,m.KR)({...o}),_=e=>{console.log(e),n.value=URL.createObjectURL(e.raw),f.value.image=e.raw},F=l,S=async()=>{const e=new FormData;for(let a in f.value)e.append(a,f.value[a]);console.log(e),f.value.id?(await u.value.validate(),await h(e),R.nk.success("修改成功"),t.value=!1,F("success","edit")):(await u.value.validate(),await w(e),R.nk.success("添加成功"),t.value=!1,F("success","add")),n.value=""},C=(0,m.KR)(),K=async e=>{if(t.value=!0,e.id){const a=await y(e.id);f.value=a.data.data,n.value=f.value.image}else f.value={...o},n.value="",(0,c.dY)((()=>{C.value.setHTML("")}))};return a({open:K}),(e,a)=>{const l=d.WK,o=i.xE,y=b.tk,F=g.j5,w=(0,c.g2)("quill-editor"),h=p.S2,R=i.US,K=v.pw;return(0,c.uX)(),(0,c.Wv)(K,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value=e),title:f.value.id?"编辑地图":"新增地图",direction:"rtl",size:"50%"},{default:(0,c.k6)((()=>[(0,c.bF)(R,{ref_key:"form",ref:u,rules:s,model:f.value,"label-width":"100px"},{default:(0,c.k6)((()=>[(0,c.bF)(o,{label:"地图名",prop:"name"},{default:(0,c.k6)((()=>[(0,c.bF)(l,{modelValue:f.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.name=e),placeholder:"请输入地图名"},null,8,["modelValue"])])),_:1}),(0,c.bF)(o,{label:"地图系列",prop:"series"},{default:(0,c.k6)((()=>[(0,c.bF)(l,{modelValue:f.value.series,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value.series=e),placeholder:"请输入地图系列"},null,8,["modelValue"])])),_:1}),(0,c.bF)(o,{label:"图片",prop:"image"},{default:(0,c.k6)((()=>[(0,c.bF)(F,{class:"avatar-uploader","show-file-list":!1,"auto-upload":!1,"on-change":_},{default:(0,c.k6)((()=>[n.value?((0,c.uX)(),(0,c.CE)("img",{key:0,src:n.value,class:"avatar"},null,8,V)):((0,c.uX)(),(0,c.Wv)(y,{key:1,class:"avatar-uploader-icon"},{default:(0,c.k6)((()=>[(0,c.bF)((0,m.R1)(k.FWt))])),_:1}))])),_:1})])),_:1}),(0,c.bF)(o,{label:"地图介绍",prop:"description"},{default:(0,c.k6)((()=>[(0,c.Lk)("div",z,[(0,c.bF)(w,{ref_key:"editorRef",ref:C,content:f.value.description,"onUpdate:content":a[2]||(a[2]=e=>f.value.description=e),"content-type":"html",theme:"snow",options:r.value},null,8,["content","options"])])])),_:1}),(0,c.bF)(o,null,{default:(0,c.k6)((()=>[(0,c.bF)(h,{onClick:S,type:"primary"},{default:(0,c.k6)((()=>a[4]||(a[4]=[(0,c.eW)("提交")]))),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])}}},K=l(8533);const x=(0,K.A)(C,[["__scopeId","data-v-1998aaf5"]]);var A=x,U=l(3634),W=(l(9759),l(7414),l(842)),L={__name:"MapSeriesSelect",props:{modelValue:{type:[Number,String]},width:{type:String,default:"240px"}},emits:["update:modelValue"],setup(e,{expose:a,emit:l}){const t=(0,m.KR)([]),u=async()=>{const e=await F();console.log("地图系列",e),t.value=e.data.data},s=e;console.log(s);const r=l;return a({getAllMapSeries:u}),u(),(a,l)=>{const u=U.P9,s=U.AV;return(0,c.uX)(),(0,c.Wv)(s,{modelValue:e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=e=>r("update:modelValue",e)),style:(0,W.Tr)({width:e.width})},{default:(0,c.k6)((()=>[((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(t.value,(e=>((0,c.uX)(),(0,c.Wv)(u,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])}}};const M=L;var X=M,E=l(4741),q=l(7462);l(8501);const j={class:"map-list"},I={class:"card-header"},T={class:"btns"},$=["src"];var P={__name:"MapPage",setup(e){const a=(0,m.KR)([]),l=(0,m.KR)(0),v=(0,m.KR)(!1),g=(0,m.KR)([]),b=(0,m.KR)(),f=(0,m.KR)({page:1,pageSize:5,name:"",series:""}),y=(0,m.KR)(),F=async()=>{console.log("查询参数",f.value),v.value=!0;const e=await _(f.value);console.log("地图列表",e.data.data),a.value=e.data.data.rows,l.value=e.data.data.total,v.value=!1},w=e=>{f.value.page=1,f.value.pageSize=e,F()},h=e=>{f.value.page=e,F()},V=()=>{f.value.page=1,F()},z=()=>{f.value.page=1,f.value.name="",f.value.series="",F()},C=async e=>{console.log(e),await q.s.confirm("你确认要删除所选地图吗？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),await S(e),R.nk.success("删除成功"),F(),b.value.getAllMapSeries()},K=()=>{y.value.open({})},x=e=>{y.value.open(e)},U=e=>{g.value=e.map((e=>e.id))},W=e=>{if("add"===e){const e=Math.ceil((l.value+1)/f.value.pageSize);f.value.page=e}F(),b.value.getAllMapSeries()};return F(),(e,_)=>{const F=p.S2,S=d.WK,R=i.xE,L=i.US,M=r.o8,q=n.zv,P=o.x0,Z=r.Up,B=s.aQ,D=u.Ik,H=t.L;return(0,c.uX)(),(0,c.CE)("div",j,[(0,c.bF)(D,{style:{"max-width":"100vw"}},{header:(0,c.k6)((()=>[(0,c.Lk)("div",I,[_[7]||(_[7]=(0,c.Lk)("span",null,"地图列表",-1)),(0,c.Lk)("div",T,[(0,c.bF)(F,{type:"primary",onClick:K},{default:(0,c.k6)((()=>_[5]||(_[5]=[(0,c.eW)("添加地图")]))),_:1}),(0,c.bF)(F,{type:"danger",onClick:_[0]||(_[0]=e=>C(g.value))},{default:(0,c.k6)((()=>_[6]||(_[6]=[(0,c.eW)("批量删除")]))),_:1})])])])),default:(0,c.k6)((()=>[(0,c.bF)(L,{inline:""},{default:(0,c.k6)((()=>[(0,c.bF)(R,{label:"地图名"},{default:(0,c.k6)((()=>[(0,c.bF)(S,{modelValue:f.value.username,"onUpdate:modelValue":_[1]||(_[1]=e=>f.value.username=e),placeholder:"请输入地图名"},null,8,["modelValue"])])),_:1}),(0,c.bF)(R,{label:"地图系列"},{default:(0,c.k6)((()=>[(0,c.bF)(X,{ref_key:"mapSeriesSelectRef",ref:b,modelValue:f.value.series,"onUpdate:modelValue":_[2]||(_[2]=e=>f.value.series=e)},null,8,["modelValue"])])),_:1}),(0,c.bF)(R,null,{default:(0,c.k6)((()=>[(0,c.bF)(F,{type:"primary",onClick:V},{default:(0,c.k6)((()=>_[8]||(_[8]=[(0,c.eW)("搜索")]))),_:1}),(0,c.bF)(F,{onClick:z},{default:(0,c.k6)((()=>_[9]||(_[9]=[(0,c.eW)("重置")]))),_:1})])),_:1})])),_:1}),(0,c.bo)(((0,c.uX)(),(0,c.Wv)(Z,{key:0,onSelectionChange:U,data:a.value,stripe:"",style:{width:"100%"}},{empty:(0,c.k6)((()=>[(0,c.bF)(P,{description:"没有数据"})])),default:(0,c.k6)((()=>[(0,c.bF)(M,{type:"selection",selectable:e.selectable,width:"55"},null,8,["selectable"]),(0,c.bF)(M,{type:"index",label:"序号",width:"80"}),(0,c.bF)(M,{prop:"name",label:"地图名",width:"180"}),(0,c.bF)(M,{prop:"description",label:"地图介绍",width:"500"}),(0,c.bF)(M,{prop:"series",label:"地图系列",width:"180"}),(0,c.bF)(M,{prop:"image",label:"图片",width:"180"},{default:(0,c.k6)((({row:e})=>[(0,c.bF)(q,{size:60},{default:(0,c.k6)((()=>[(0,c.Lk)("img",{src:e.image||(0,m.R1)(E)},null,8,$)])),_:2},1024)])),_:1}),(0,c.bF)(M,{fixed:"right",label:"操作",width:"180"},{default:(0,c.k6)((({row:e})=>[(0,c.bF)(F,{icon:(0,m.R1)(k.ffu),circle:"",type:"primary",plain:"",onClick:a=>x(e)},null,8,["icon","onClick"]),(0,c.bF)(F,{icon:(0,m.R1)(k.epd),circle:"",type:"danger",plain:"",onClick:a=>C(e.id)},null,8,["icon","onClick"])])),_:1})])),_:1},8,["data"])),[[H,v.value]]),(0,c.bF)(B,{"current-page":f.value.page,"onUpdate:currentPage":_[3]||(_[3]=e=>f.value.page=e),"page-size":f.value.pageSize,"onUpdate:pageSize":_[4]||(_[4]=e=>f.value.pageSize=e),"page-sizes":[3,5,8,10],size:"large",background:!0,layout:"jumper, total, sizes, prev, pager, next",total:l.value,onSizeChange:w,onCurrentChange:h,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"]),(0,c.bF)(A,{ref_key:"articleRef",ref:y,onSuccess:W},null,512)])),_:1})])}}};const Z=(0,K.A)(P,[["__scopeId","data-v-5f1bc70a"]]);var B=Z}}]);
//# sourceMappingURL=727.959e248c.js.map